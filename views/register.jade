extends layout

block content
  .row
    .col-sm-8.col-sm-offset-2
      h1 Register
      form(role='form', action='/register', method='post')
        .form-group.has-feedback#usernameGroup
          label(for='username' class='control-label')
            | Username
          input(type='text', name='username', placeholder='Enter username', autofocus, id='username', class='form-control', aria-describedby="helpBlock")
          span.glyphicon.glyphicon-ok.form-control-feedback#successIcon(aria-hidden='true')
          span.glyphicon.glyphicon-remove.form-control-feedback#errorIcon(aria-hidden='true')
          span#helpBlock.help-block
            | That account name is in use, please try another.
        .form-group
          label(for='password')
            | Password
          input(type='password', name='password', placeholder='Password', class='form-control')
        button(type='submit', class="btn btn-default") Submit
  
  script.
    $(document).ready(function() {
      $('#username').on('keyup', function() {
        var val = $(this).val();
        if(val) {
          $.get('/register/check/'+$(this).val(), function(data) {
            if(!data.success) {
              $('#usernameGroup').addClass('has-error').removeClass('has-success');
              $('#helpBlock').slideDown('fast');
            } else {
              $('#usernameGroup').addClass('has-success').removeClass('has-error');
              $('#helpBlock').slideUp('fast');
            }
          });
        } else {
          $('#usernameGroup').removeClass('has-error has-success');
        }
      });
    });
